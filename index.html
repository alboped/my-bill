<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>天居园3201记账系统</title>
		<script src="https://cdn.wilddog.com/js/client/current/wilddog.js"></script>
		<script src="//cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
		<script>
			//数据对象
			var db = (function(){
				var ref = new Wilddog("https://1257.wilddogio.com");
				var node = ref.child('accountList');
				return {
					node: node,
					ref: ref
				}
			})();

			//操作模块
			var module = (function(){
				//记账
				var saveAccount = function(price, type){
					db.node.push({
						price: price,
						type: type
					});
				}

				//查询账单列表
				var queryAccountList = function(){
					db.node.on('value', function(data){
						console.dir(data.val());
						$('.accountList').html('');
						$.each(data.val(), function(key, value){
							$('.accountList').append('<li>金额：' + value.price + ' 内容：' + value.type + '</li>')
						})
					})
				}

				return {
					save: saveAccount,
					query: queryAccountList
				}
			})();

			//页面初始化
			$(function(){
				//记账按钮
				$('#submit').click(function(){
					module.save($('.price').val(), $('.type').val());
					$('.price, .type').val('');
					module.query();
				});
				module.query();
			})
		</script>
	</head>
	<body>
		<ul class="accountList"></ul>
		<form action="">
			<div>
				金额：<input type="text" name="price" class="price" />
			</div>
			<div>
				项目：<input type="text" name="type" class="type" />
			</div>
			<div>
				<input type="button" value="提交" id="submit" />
			</div>
		</form>
	</body>
</html>